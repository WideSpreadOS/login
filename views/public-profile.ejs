<style>
.jumbotron {
    border-radius: 15px;
    background: transparent;
}
.name-header {
    width: 85%;
    margin: 0 auto;
}
.name-header {
    padding: 15px;
    padding-bottom: 0;
    background: rgba(0, 0, 0, 0.301);
    backdrop-filter: blur(4px);
}
.name-header h1 {
    font-size: 1.1rem;
    color: #fff;
}
.user-header {
    padding-bottom: 10px;
    background:rgba(255, 255, 255, 0.301);
    background-image: url('/image/<%= profile.user_avatar %>');
    background-size: cover;
    backdrop-filter: blur(2px);
    position: relative;
    height: 500px;
    
}
.info-header {
    border-top: groove 2px lightskyblue;
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    background: rgba(255, 255, 255, 0.301);
    backdrop-filter: blur(2px);
    text-shadow: 0 0 3px #000;
    border-bottom-left-radius: 20px;
    border-bottom-right-radius: 20px;
}
.info-header h5 {
    border-bottom: groove 2px lightskyblue;
    background:rgba(80, 80, 80, 0.459);
    backdrop-filter: blur(4px);
    padding-top: 20px;
    padding-bottom: 20px;
    box-shadow: inset 0 0 3px 1px rgba(0, 0, 0, 0.301);
}
.info-header-contact {
    display: inline-flex;
    width: 100%;
    text-align: center;
    border-bottom: solid 1px #fff;
    padding-bottom: 10px;
}
.info-header-contact a {
    margin-left: 20px;
    padding: 5px;
}
.info-header-bottom {
    display: inline-flex;
    width: 100%;
    margin-top: 5px;
}
.info-header-bottom-half {
    width: 50%;
    margin-top: 10px;
}
.info-header a {
    text-align: center;
    font-weight: bold;
    color: #fff;
    text-shadow: 0 0 3px lightskyblue;
}
.info-header p {
    text-align: center;
    color: #fff;
    margin-bottom: 0;
}

.add-friend-container button {
    outline: none;
    border: none;
    border-top-left-radius: 10px;
    border-top-right-radius: 10px;
    width: 90%;
    height: 40px;
    margin: 0 auto;
    margin-top: 10px;
    background: green;
    border: groove 2px green;
    border-bottom: none;
    box-shadow: inset 0 2px 2px 1px rgba(0, 0, 0, 0.445);
}
.find-new-friends {
    display: inline-flex;
    max-width: 90vw;
    overflow-x: scroll;
    padding: 20px;
    margin: 0 auto;
    margin-bottom: 30px;
    padding-right: 80px;
}
.spread-container {
    padding: 5px;
    padding-top: 15px;
    width: 100%;
    background: rgba(255, 255, 255, 0.37);
    backdrop-filter: blur(2px);
}
.spread-container h3 {
    text-align: center;
}
.spread-container-sub {
    padding: 5px;
    width: 98%;
    margin-left: 1%;
}
.social-list-item {
    background: rgba(255, 255, 255, 0.384);
    backdrop-filter: blur(4px);
    padding: 5px;
    margin-top: 5px;
    border-radius: 5px;
}
.social-list-item img {
    width: 20px;
    height: 20px;
}
.social-list-item a {
    height: 20px;
    color: #fff;
    overflow-y: hidden;
    width: 50%;
    padding-left: 5px;
}
.possible-friend-image {
    overflow: hidden;
}
.post-container {
    background: rgba(255, 255, 255, 0.3);
    width: 90%;
    margin-left: 0;
    padding: 0;
    border: none;
    border-radius: 15px;
    border-bottom: groove 2px lightskyblue;
    border-top: groove 2px lightskyblue;
}
.post-profile-image {
    width: 100%;
    height: 160px;
    text-align: center;
    border-bottom-left-radius: 8px;
    border-bottom-right-radius: 8px;
}
.post-profile-image img {
    width: 100px;
    height: 100%;
    border-bottom-left-radius: 8px;
    border-bottom-right-radius: 8px;
}
.post-author {
    backdrop-filter: 4px;
    margin-top: 20px;
    text-align: center;
    border: groove 2px lightskyblue;
    border-left: none;
    border-right: none;
    padding-top: 10px;
}
.post-body {
    padding: 15px;
    color: #fff;
}
.post-comments {
    position: relative;
    background: rgba(150, 150, 150, 0.3);
    margin-top: -20px;
    margin-bottom: 40px;
    width: 80%;
    margin-left: 5%;
    border-bottom: groove 2px lightskyblue;
    border-bottom-left-radius: 8px;
    border-bottom-right-radius: 8px;
}
.post-comments h4 {
    text-align: center;
    padding: 10px;
}

.post-comments p {
    color: #fff;
}
.post-comment {
    margin-bottom: 10px;
    background: rgba(255, 255, 255, 0.3);
    padding-bottom: 10px;
    border-bottom: groove 2px lightskyblue;
    border-top: groove 2px lightskyblue;
}
.comment-layout {
    display: inline-flex;
}
.comment-left {
    width: 80px;
    padding-top: 10px;
    border-top-right-radius: 8px;
    border-bottom-right-radius: 8px;
}
.comment-right {
    width: fit-content;
}
.comment-author-image {
    border-top-right-radius: 8px;
    border-bottom-right-radius: 8px;
}
.comment-author-image img {
    border-top-right-radius: 8px;
    border-bottom-right-radius: 8px;
}
.comment-author-name {
    padding: 10px;
    display: block;
    width: 100%;
}
.comment-body {
    padding: 8px;
}


</style>
<div class="user-background-image">
    <% if (profile.user_background_image) { %>
        <img src="/image/<%= profile.user_background_image %>" alt="<%= profile.fname %> <%= profile.lname %>'s Avatar">
        <%} else { %>
            <div class="user-background-color" style="width: 100vw; height: 100vh; position: fixed; top: 0; left: 0; background: <%= profile.favColor1 %>"></div>
            <% } %>
        </div>
        <%- include('partials/mainHeaderSiteMenu') %>
        <%- include('partials/mainHeaderPageMenu') %>

<div class="jumbotron mt-4">
    <div class="row name-header" style=" box-shadow: inset 0 0 15px <%= profile.favColor1 %>;">
        <h1 style="color: rgba(80, 80, 80, 0.884) ;text-shadow: 0 0 8px <%= profile.favColor1 %>; font-weight: bolder;"><%= profile.fname %> <%= profile.lname %></h1>

    </div>
    <div class="user-header">
        <div class="">
        <div class="info-header">
            <h5><%= profile.current_occupation %></h5>
            <div class="info-header-contact">
                <a href="mailto:<%= profile.email %>"><i style="margin-right: 10px;" class="far fa-envelope"></i></a>
                <a href="mailto:<%= profile.phone1 %>"><i style="margin-right: 10px;" class="fas fa-phone"></i></a>
            </div>
            <div class="info-header-bottom">
                <div class="info-header-bottom-half">
                    <p><%= profile.town %>, <%= profile.state %></p>
                    <p><%= profile.country %></p>
                </div>
                <div class="info-header-bottom-half" style="border-left: solid 1px #fff;">
                    <p> Age: <%= profile.age %></p>
                    <p> <%= profile.gender %></p>
                </div>
            </div>
                <div class="add-friend-container">
                    <form action="/users/<%= profile._id %>/add-friend" method="POST">
                        <input type="text" name="friends" value="<%= profile._id %>" style="display: none;">
                        <button class="add-friend" type="submit"><i class="fas fa-user-plus"></i></button>
                    </form>
                </div>
    </div>
        </div>
    </div>
    <div class="row">
        <div class="col-12 spread-container-about" style=" border-top-left-radius: 20px; border-bottom-left-radius: 20px;">
            <h3 style="text-align: center; padding: 20px;">About <%= profile.fname %></h3>
            <p style="padding: 30px"><%= profile.about %></p>
        </div>

    </div>
    <div class="spread-container">
        <h3><%= profile.fname %>'s Social Life</h3>
        <div class="spread-container-sub">
            <% if(profile.social.instagram){ %>
            <div class="social-list-item">
                    <img src="/images/system/instagram_1a1a1a.png" alt="Instagram">
                    <a href="<%= profile.social.instagram %>" target="_blank"><%= profile.social.instagram %></a>
                </div>
                    <% } else { %>
                        <span></span>
                    <% } %>
            <% if(profile.social.facebook){ %>
            <div class="social-list-item">
                    <img src="/images/system/facebook_1a1a1a.png" alt="Facebook">
                    <a href="<%= profile.social.facebook %>" target="_blank"><%= profile.social.facebook %></a>
                </div>
                    <% } else { %>
                        <span></span>
                    <% } %>
            <% if(profile.social.twitter){ %>
            <div class="social-list-item">
                    <img src="/images/system/twitter_1a1a1a.png" alt="Twitter">
                    <a href="<%= profile.social.twitter %>" target="_blank"><%= profile.social.twitter %></a>
                </div>
                    <% } else { %>
                        <span></span>
                    <% } %>
        </div>
        <h3 style="text-align: center; padding-top: 20px;"><%= profile.fname %>'s Work Life</h3>
        <div class="spread-container-sub">
            <% if(profile.social.github){ %>
            <div class="social-list-item">
                    <img src="/images/system/github_1a1a1a.png" alt="Github">
                    <a href="<%= profile.social.github %>" target="_blank"><%= profile.social.github %></a>
                </div>
                <% } else { %>
                    <span></span>
                <% } %>
                <% if(profile.social.linkedin){ %>
            <div class="social-list-item">
                    <img src="/images/system/linkedin_1a1a1a.png" alt="LinkedIn">
                    <a href="<%= profile.social.linkedin %>" target="_blank"><%= profile.social.linkedin %></a>
                </div>
                <% } else { %>
                    <span></span>
                <% } %>
        </div>
    </div>
    
</div>
    
    <hr class="my-4">
    <div class="outer_cont_container" style="margin-top: 150px;">
        <div class="cont_container">
            <div class="cont_inner_container">
    <% profileImages.forEach(function(image){ %>
            <div style="padding: 7px;">
                <div> 
                    <div> 
                        <a href="/image/<%= image.img.data %>">
                            <div class="med-image"> 
                                <img src="/image/<%= image.img.data %>" width="300px" height="300px"> 
                            </div> 
                        </a>
                    </div> 
                </div> 
                
            </div>
        
        <% }); %>
    
            </div>
        </div>
    </div>
    
        <!-- Friend List -->
        <div class="friend-container">
            <h2 style="text-align: center; margin-bottom: 20px;"><%= profile.fname %>'s Friends</h2>
            <div class="row">
                <div class="find-new-friends">
                        <% profile.friends.forEach(function(friend){ %>
                            <div class="possible-friend" style="box-shadow: 0 0 10px <%= friend.favColor1 %>;">
                                <a href="/users/<%= friend.id %>">
                                    <div class="possible-friend-image" style="border: groove 1px <%= friend.favColor1 %>; border-top: none;">
                                        <% if (friend.user_avatar) { %>
                                            <img src="/image/<%= friend.user_avatar   %>" alt="<%= profile.fname %> <%= profile.lname %>'s Avatar" width="60px">
                                        <%} else { %>
                                            <img src="/images/system/default-user_1a1a1a.png" alt="Default Avatar"  width="60px" style="box-shadow: 0 3px 10px <%= friend.favColor1 %>; background: #000" >
                                            <% } %>
                                    </div>
                                <h3 style="text-shadow: 0 0 3px <%= friend.favColor1 %>; border-top: solid 1px <%= friend.favColor1 %>; border-bottom: solid 1px <%= friend.favColor1 %>;"><%= friend.fname %> <%= friend.lname %></h3>
                                <p><%= friend.town %>, <%= friend.state %></p>
                                <p><%= friend.country %></p>
                                <small><%= friend.gender %></small>
                                <p><%= friend.email %></p>
                                
                            </a>
                        </div>
                                <% }); %>
                </div>
            </div>
        </div>
    <div class="row">

                <h5 style="text-align: center; width: 100%;">Top Posts</h5>
                <ul>
                    <% posts.forEach(function(post){ %>
                        <div class="post-container">
                            <div class="post-profile-image">
                                    <% if (profile.user_avatar) { %>
                                        <img src="/image/<%= profile.user_avatar %>" alt="<%= profile.fname %> <%= profile.lname %>'s Avatar">
                                        <%} else { %>
                                            <img src="/images/system/default-user_1a1a1a.png" alt="<%= profile.fname %> <%= profile.lname %>'s Avatar">
                                            <% } %>
                            </div>
                            <div class="post-author">
                                <h3><%= profile.fname %> <%= profile.lname %></h3>
                            </div>
                            <div class="post-body">
                                <p><%= post.postBody %></p>
                            </div>
                        </div>
                            <div class="post-comments">
                                    <h4>Comments</h4>
                                    <% if (post.comments) { %>
                                        <% post.comments.forEach(function(comment) { %>
                                            <div class="post-comment">
                                                

                                                <div class="comment-layout">
                                                    <div class="comment-left">
                                                        <% if (comment.author.user_avatar) { %>
                                                            <div class="comment-author-image">
                                                            <img src="/image/<%= comment.author.user_avatar %>" alt="" width="auto" height="80px">
                                                        </div>
                                                            <% } else { %>
                                                            <img src="/images/system/default-user_1a1a1a.png" alt="" width="80px" height="80px">
                                                            <% } %>
                                                    </div>
                                                    <div class="comment-right">
                                                        <div class="comment-author-name">
                                                            <h6><%= comment.author.fname %> <%= comment.author.lname %></h6>
                                                        </div>
                                                        <div class="comment-body">
                                                            <p><%= comment.commentBody %></p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        <% }) %>
                                        <% } else { %>
                                            <p>Be the first to comment...</p>
                                        <% } %>
                            </div>

<!--                             <a href="/users/posts/<%= post.id %>">See More</a> -->

                            
                        <% }); %>
                    </ul> 

                    <h5 style="text-align: center; width: 80%; margin-left: 10%; margin-top: 20px; border-top: solid 1px lightskyblue; padding-top: 20px;">Top Articles</h5>
                    <ul>
                        <% articles.forEach(function(article){ %>
                            <li style="list-style: none;">
                                <div class="public-post-container">
                                    <div class="public-post">
                                        <img src="/images/system/default-post_1a1a1a.png" alt="Default Post" width="50px" height="50px">
                                        <small class="d-inline"><%= article.createdAt.toLocaleDateString() %> - <%= article.createdAt.toLocaleTimeString('en-US') %></small>
                                        <h3><%= article.articleTitle %></h3>
                                        <h5><%= article.articleHeader %></h5>
                                        <p><%= article.articleBody %></p>
                                        <a href="/users/articles/<%= article.id %>">See More</a>
                                        <div class="post-option-bar">
                                            <i class="fas fa-copy"></i>
                                            <i class="fas fa-hashtag"></i>
                                            <i class="fas fa-plus"></i>
                                            <i class="fas fa-share-alt"></i>
                                        </div>
                                    </div>  
                                    
                                </div>
                            </li>
                            <% }); %>
                        </ul> 
                </div>
            </div>
        </div>